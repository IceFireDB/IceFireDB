<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Codec layer design # The codec layer is the glue of the IceFireDB data expression layer, because the bottom layer of IceFireDB supports many storage engines, including centralized storage such as web2 disk, OSS, leveldb, and badger, as well as web3&rsquo;s IPFS, crdt-kv, and IPFS-LOG For this kind of decentralized storage, the storage interface provided by any kind of storage is simple and not standardized. The codec layer of IceFireDB-NoSQL is abstracted through a unified driver layer, and by encoding and decoding many instruction semantics into a KV model, a richer data expression layer is built to support more data scenarios, such as Strings\Hashs\Sets\Lists \Sorted Sets."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:type" content="website"><meta property="og:image" content="https://res.cloudinary.com/malloc/image/upload/v1666510486/icefiredb/logo_z8koem.png"><meta property="og:title" content="Codec layer"><meta property="og:description" content="Codec layer design # The codec layer is the glue of the IceFireDB data expression layer, because the bottom layer of IceFireDB supports many storage engines, including centralized storage such as web2 disk, OSS, leveldb, and badger, as well as web3&rsquo;s IPFS, crdt-kv, and IPFS-LOG For this kind of decentralized storage, the storage interface provided by any kind of storage is simple and not standardized. The codec layer of IceFireDB-NoSQL is abstracted through a unified driver layer, and by encoding and decoding many instruction semantics into a KV model, a richer data expression layer is built to support more data scenarios, such as Strings\Hashs\Sets\Lists \Sorted Sets."><meta property="og:type" content="article"><meta property="og:url" content="https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/codec/"><meta property="article:section" content="IceFireDB"><title>Codec layer | IceFireDB Documentation</title><link rel=manifest href=/icefiredb_docs/manifest.json><link rel=icon href=/icefiredb_docs/favicon.ico type=image/x-icon><link rel=stylesheet href=/icefiredb_docs/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous><script defer src=/icefiredb_docs/flexsearch.min.js></script>
<script defer src=/icefiredb_docs/en.search.min.6d1e8664bf52aa061ff8f52ed8fbf0924b12a5f8743d1947e84f3bccf6f340f7.js integrity="sha256-bR6GZL9SqgYf+PUu2PvwkksSpfh0PRlH6E87zPbzQPc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/icefiredb_docs/><span>IceFireDB Documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://www.icefiredb.xyz/ target=_blank rel=noopener>Official Site</a></li><li><a href=https://github.com/icefiredb target=_blank rel=noopener>Open Source</a></li></ul><ul><li class=book-section-flat><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/>Overview</a><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/engine_overview/>Engine Overview</a><ul></ul></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/vocabulary/>Vocabulary</a><ul></ul></li><li><span>IceFireDB-NoSQL</span><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/quick_start/>Quick Start</a><ul></ul></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/>Designs</a><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/network/>Network layer</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/storage/>Storage layer</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/protocol/>Protocol layer</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/codec/ class=active>Codec layer</a></li></ul></li><li><span>Develop</span><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb-crdt-kv/>icefiredb-crdt-kv</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb-ipfs-log/>icefiredb-ipfs-log</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb_proxy/>icefiredb-proxy</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/redhub/>redhub-frame</a></li></ul></li><li><span>Project Comparison</span><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/project-comparison/orbitdb/>OrbitDB</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/project-comparison/threaddb/>ThreadDB</a></li></ul></li></ul></li><li><span>IceFireDB-SQLite</span><ul><li><input type=checkbox id=section-9a14413c81006dc1ffda9fa39f8e6bac class=toggle>
<label for=section-9a14413c81006dc1ffda9fa39f8e6bac class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/overview/>OverView</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/network/>NetWork</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/storage/>Storage</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/protocol/>Protocol</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/codec/>Codec</a></li></ul></li></ul></li><li><span>IceFireDB-Redis-Proxy</span><ul><li><input type=checkbox id=section-3bf1c87fb952709c4563285ca0f995a6 class=toggle>
<label for=section-3bf1c87fb952709c4563285ca0f995a6 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/architecture/overview/>OverView</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/architecture/network/>NetWork</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/architecture/storage/>Storage</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/architecture/protocol/>Protocol</a></li></ul></li></ul></li><li><span>IceFireDB-SQLProxy</span><ul><li><input type=checkbox id=section-fffdb9e9ea7862273e9c9ce0d60c9801 class=toggle>
<label for=section-fffdb9e9ea7862273e9c9ce0d60c9801 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlproxy/architecture/overview/>OverView</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlproxy/architecture/network/>NetWork</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlproxy/architecture/storage/>Storage</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlproxy/architecture/protocol/>Protocol</a></li></ul></li></ul></li><li><span>IceFireDB-PubSub</span><ul><li><input type=checkbox id=section-ef1f7256f510a0aabdfc342eef0e3348 class=toggle>
<label for=section-ef1f7256f510a0aabdfc342eef0e3348 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/architecture/overview/>OverView</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/architecture/network/>NetWork</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/architecture/storage/>Storage</a></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/architecture/protocol/>Protocol</a></li></ul></li></ul></li><li><a href=https://www.icefiredb.xyz/icefiredb_docs/icefiredb/faqs/>FAQs</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/icefiredb_docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Codec layer</strong>
<label for=toc-control><img src=/icefiredb_docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#codec-advantages>Codec advantages</a></li><li><a href=#codec-layer-value>Codec Layer value</a></li></ul></nav></aside></header><article class=markdown><h1 id=codec-layer-design>Codec layer design
<a class=anchor href=#codec-layer-design>#</a></h1><p>The codec layer is the glue of the IceFireDB data expression layer, because the bottom layer of IceFireDB supports many storage engines, including centralized storage such as web2 disk, OSS, leveldb, and badger, as well as web3&rsquo;s IPFS, crdt-kv, and IPFS-LOG For this kind of decentralized storage, the storage interface provided by any kind of storage is simple and not standardized. The codec layer of IceFireDB-NoSQL is abstracted through a unified driver layer, and by encoding and decoding many instruction semantics into a KV model, a richer data expression layer is built to support more data scenarios, such as Strings\Hashs\Sets\Lists \Sorted Sets.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>+-------------------------------------------------------------+
</span></span><span style=display:flex><span>|                        Query Processor                      |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>|   |                     Query Parser                    |   |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>|   |                   Query Optimizer                   |   |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>+---+--------------------------+--------------------------+---+
</span></span><span style=display:flex><span>                               |
</span></span><span style=display:flex><span>+------------------------------v------------------------------+
</span></span><span style=display:flex><span>|                            Codec                            |
</span></span><span style=display:flex><span>|    +-----------+                           +-----------+    |
</span></span><span style=display:flex><span>|    |   Encode  |                           |   Decode  |    |
</span></span><span style=display:flex><span>|    +-----------+                           +-----------+    |
</span></span><span style=display:flex><span>|                 support: kv、list、hash、set                 |
</span></span><span style=display:flex><span>+----------+---------------------------------------^----------+
</span></span><span style=display:flex><span>           |                                       |
</span></span><span style=display:flex><span>+----------+---------------------------------------+----------+
</span></span><span style=display:flex><span>|          |put              KV Engine             |Get       |
</span></span><span style=display:flex><span>|    +-----v----+                            +-----+----+     |
</span></span><span style=display:flex><span>|    | put(a,b) |                            |  Get(a)  |     |
</span></span><span style=display:flex><span>|    +-----+----+                            +-----+----+     |
</span></span><span style=display:flex><span>|          | a:b            +-------+              | a        |
</span></span><span style=display:flex><span>|    +-----v----+    +------&gt; store &lt;----+   +-----v----+     |
</span></span><span style=display:flex><span>|    |  CID(b)  +----+      +-------+    +---+ cat(hash)|     |
</span></span><span style=display:flex><span>|    +-----+----+                            +-----+----+     |
</span></span><span style=display:flex><span>|          | add(b)                                | cat      |
</span></span><span style=display:flex><span>|  --------v---------------------------------------v-----     |
</span></span><span style=display:flex><span>|           Leveldb\Badger\OSS\IPFS\CRDT\IPFS-LOG             |
</span></span><span style=display:flex><span>+-------------------------------------------------------------+
</span></span></code></pre></div><p>As an important glue layer, the codec layer connects the network layer, request layer, and KV storage layer.</p><h2 id=codec-advantages>Codec advantages
<a class=anchor href=#codec-advantages>#</a></h2><p>In the decentralized database scenario, although the community also has a decentralized storage solution similar to the KV model, the KV model cannot meet the complex use of upper-level applications. We believe that rich data structures need to be supported to support the decentralized development of applications, including NoSQL data models (such as strings\hashs\lists\sets\sorted sets data structures). Just as the prosperity of the web2 application ecology is inseparable from the contribution of database infrastructure such as memcached, redis, and mysql, IceFireDB provides richer data types and can support data decentralization in more complex scenarios.</p><p>The encoding and decoding layer encodes data commands and parameters to meet the conversion of many rich instruction data models to KV models. Under the function of this conversion layer, the complex shielding layer of the data model layer and the storage engine layer is effectively constructed.</p><ol><li><p>The data instruction layer does not need to care about the underlying storage engine, so it can adapt to various storage engine drivers with the help of the codec layer.</p></li><li><p>The underlying storage engine continues to provide a simple data operation interface (put\get\del\iterator), without direct coupling and customization with the data presentation layer, and the abstract storage driver layer of the codec layer maintains the easy work of the two layers.</p></li></ol><p><strong>Any problem in computer science can be solved by another layer of indirection.</strong></p><h2 id=codec-layer-value>Codec Layer value
<a class=anchor href=#codec-layer-value>#</a></h2><p>In addition to adding a richer data model and isolating the complexity of the request layer and storage layer, the codec layer of IceFireDB also has the following functions:</p><ol><li><strong>Improve data access speed</strong>: A memory buffer layer is added to the encoding layer to effectively improve the performance of data access.</li><li><strong>Calculate the middle layer</strong>：The support of complex data structures often requires a certain amount of calculation. At present, the coding layer mainly performs CPU calculations, and subsequent calculations can be combined with GPU and FPGA, which can expand high-performance data calculations and add more possibilities for decentralized databases.</li><li><strong>blockchain/web3 connection layer</strong>: At present, whether it is a web2 or web3 database scenario, data access is the focus of attention, but with the development of blockchain and web3, trusted computing of data and non-tamperable proofs are becoming more and more important. The codec layer of IceFireDB is playing an important role , can be used to combine the blockchain data structure to build web3 side chain infrastructure, reducing the calculation and storage burden of the blockchain layer.</li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#codec-advantages>Codec advantages</a></li><li><a href=#codec-layer-value>Codec Layer value</a></li></ul></nav></div></aside></main></body></html>