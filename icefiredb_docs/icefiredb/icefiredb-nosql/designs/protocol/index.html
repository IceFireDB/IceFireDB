<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Protocol layer design
  #

A good access method of the application can accelerate the growth of the application ecology, and a good protocol design can reduce the transformation cost of the stock application, so the protocol layer is an important component of the IceFireDB software stack. The communication protocol of IceFireDB-NoSQL fully integrates the Redis RESP protocol, which mainly includes the following two parts of the protocol:


Data control protocol: Complete support for RESP clients, supporting functional requirements for database data access."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:type" content="website"><meta property="og:image" content="https://res.cloudinary.com/malloc/image/upload/v1666510486/icefiredb/logo_z8koem.png"><meta property="og:url" content="https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/protocol/"><meta property="og:site_name" content="IceFireDB Documentation"><meta property="og:title" content="Protocol layer"><meta property="og:description" content=" Protocol layer design # A good access method of the application can accelerate the growth of the application ecology, and a good protocol design can reduce the transformation cost of the stock application, so the protocol layer is an important component of the IceFireDB software stack. The communication protocol of IceFireDB-NoSQL fully integrates the Redis RESP protocol, which mainly includes the following two parts of the protocol:
Data control protocol: Complete support for RESP clients, supporting functional requirements for database data access."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="icefiredb"><title>Protocol layer | IceFireDB Documentation</title>
<link rel=manifest href=/icefiredb_docs/manifest.json><link rel=icon href=/icefiredb_docs/favicon.ico type=image/x-icon><link rel=stylesheet href=/icefiredb_docs/book.min.b217cc02c67832c758393b43eb4be5c8cf053fb3c4a02dee3fdd3805ce53f993.css integrity="sha256-shfMAsZ4MsdYOTtD60vlyM8FP7PEoC3uP904Bc5T+ZM=" crossorigin=anonymous><script defer src=/icefiredb_docs/flexsearch.min.js></script><script defer src=/icefiredb_docs/en.search.min.e2d4ffbe7302880d97331bdf5598cd4a2e1adc1179e111d1cae5f4bedfad98a3.js integrity="sha256-4tT/vnMCiA2XMxvfVZjNSi4a3BF54RHRyuX0vt+tmKM=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/icefiredb_docs/><span>IceFireDB Documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://www.icefiredb.xyz/ target=_blank rel=noopener>Official Site</a></li><li><a href=https://github.com/icefiredb target=_blank rel=noopener>Open Source</a></li></ul><ul><li class=book-section-flat><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/>Overview</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/engine_overview/>Engine Overview</a><ul></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/vocabulary/>Vocabulary</a><ul></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/>IceFireDB NoSQL Engine</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/quick_start/>Quick Start</a><ul></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/>Designs</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/overview/>Overview</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/network/>Network layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/storage/>Storage layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/protocol/ class=active>Protocol layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/codec/>Codec layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/storage-drivers/>Storage Drivers</a></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/tutorials/>Tutorials</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/tutorials/getting-started/>Getting Started Tutorial</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/tutorials/performance-benchmarking/>Performance Benchmarking</a></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/deploy/>Deploy</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/deploy/configuration/>Configuration Guide</a></li></ul></li><li><span>Develop</span><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb-crdt-kv/>icefiredb-crdt-kv</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb-ipfs-log/>icefiredb-ipfs-log</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb_proxy/>icefiredb-proxy</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/redhub/>redhub-frame</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/api-reference/>API Reference</a></li></ul></li><li><span>Project Comparison</span><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/project-comparison/orbitdb/>OrbitDB</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/project-comparison/threaddb/>ThreadDB</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/>IceFireDB-SQLite</a><ul><li><input type=checkbox id=section-d28adc5f935baf9f2270b11342515dec class=toggle>
<label for=section-d28adc5f935baf9f2270b11342515dec class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/overview/>Overview</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/>IceFireDB-Redis-Proxy</a><ul><li><input type=checkbox id=section-197cd7a03ef88813eee099fa35466d3e class=toggle>
<label for=section-197cd7a03ef88813eee099fa35466d3e class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/architecture/overview/>Overview</a></li></ul></li></ul></li><li><span>IceFireDB-SQLProxy</span><ul><li><input type=checkbox id=section-87903bd5b525679072ad1825563a57f2 class=toggle>
<label for=section-87903bd5b525679072ad1825563a57f2 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlproxy/architecture/overview/>Overview</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/>IceFireDB-PubSub</a><ul><li><input type=checkbox id=section-d2e27c9da60e491bca2bc610c135b235 class=toggle>
<label for=section-d2e27c9da60e491bca2bc610c135b235 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/architecture/overview/>Overview</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/faqs/>Frequently Asked Questions</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/icefiredb_docs/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Protocol layer</strong>
<label for=toc-control><img src=/icefiredb_docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#protocol-advantages>Protocol advantages</a></li><li><a href=#data-control-protocol>Data control protocol</a></li><li><a href=#cluster-control-protocol>Cluster control protocol</a></li></ul></nav></aside></header><article class=markdown><h1 id=protocol-layer-design>Protocol layer design
<a class=anchor href=#protocol-layer-design>#</a></h1><p>A good access method of the application can accelerate the growth of the application ecology, and a good protocol design can reduce the transformation cost of the stock application, so the protocol layer is an important component of the IceFireDB software stack. The communication protocol of IceFireDB-NoSQL fully integrates the Redis RESP protocol, which mainly includes the following two parts of the protocol:</p><ol><li><p><strong>Data control protocol</strong>: Complete support for RESP clients, supporting functional requirements for database data access.</p></li><li><p><strong>Cluster control protocol</strong>: Satisfy the client&rsquo;s command protocol for controlling the nodes of the IceFireDB cluster and viewing the status and availability status of the cluster nodes.</p></li></ol><pre tabindex=0><code>+-------------------------------------------------------------+
|                           Transport                         |
| +---------------+    +---------------+    +---------------+ |
| |    Cluster    |    |    Cluster    |    |    Cluster    | |
| | communication |    | communication |    | communication | |
| +---------------+    +---------------+    +---------------+ |
+-+---------------+----+-------^-------+----+---------------+-+
                               |
+------------------------------v------------------------------+
|                        Query Processor                      |
|   +-----------------------------------------------------+   |
|   |                     Query Parser                    |   |
|   +-----------------------------------------------------+   |
|   +-----------------------------------------------------+   |
|   |                   Query Optimizer                   |   |
|   +-----------------------------------------------------+   |
+-------------------------------------------------------------+
</code></pre><p>As can be seen from the figure above, the cluster control protocol is located above the data read and write protocol. The client (redis cluster client, IceFireDB-Proxy) obtains the master-slave structure of the cluster nodes according to the cluster status, and selects the relevant master and slave nodes Perform data read and write operations. For the request traffic carried by IceFireDB, it will enter the request processing cycle. During the request processing cycle, it will analyze and optimize the client request.</p><h2 id=protocol-advantages>Protocol advantages
<a class=anchor href=#protocol-advantages>#</a></h2><p>At present, the web2 ecology of RESP protocol clients is very rich, and mainstream computer languages have been fully covered. IceFireDB is firstly compatible with the RESP NoSQL protocol, which can quickly meet the needs of existing application systems to access IceFireDB-NoSQL.</p><p><img src=https://res.cloudinary.com/malloc/image/upload/v1666342853/icefiredb/docs/197156690-fa25a9c2-a8a4-4b69-bacb-dd4ff9915f06_goozlm.png alt=image></p><p>As a decentralized database, IceFireDB is compatible with the RESP protocol, and can hide high technical intelligence from the user layer. Users do not need to understand P2P, RAFT, CRDT, IPFS-LOG and other technologies, and only need to follow the RESP protocol to choose the appropriate client for application You can operate the database to read and write, and quickly meet the access and transformation of the business system.</p><h2 id=data-control-protocol>Data control protocol
<a class=anchor href=#data-control-protocol>#</a></h2><table><thead><tr><th style=text-align:left>Strings</th><th style=text-align:left>Hashes</th><th style=text-align:left>Lists</th><th style=text-align:left>Sets</th><th style=text-align:left>Sorted Sets</th></tr></thead><tbody><tr><td style=text-align:left>APPEND</td><td style=text-align:left>HSET</td><td style=text-align:left>RPUSH</td><td style=text-align:left>SADD</td><td style=text-align:left>ZADD</td></tr><tr><td style=text-align:left>BITCOUNT</td><td style=text-align:left>HGET</td><td style=text-align:left>LPOP</td><td style=text-align:left>SCARD</td><td style=text-align:left>ZCARD</td></tr><tr><td style=text-align:left>BITOP</td><td style=text-align:left>HDEL</td><td style=text-align:left>LINDEX</td><td style=text-align:left>SDIFF</td><td style=text-align:left>ZCOUNT</td></tr><tr><td style=text-align:left>BITPOS</td><td style=text-align:left>HEXISTS</td><td style=text-align:left>LPUSH</td><td style=text-align:left>SDIFFSTORE</td><td style=text-align:left>ZREM</td></tr><tr><td style=text-align:left>DECR</td><td style=text-align:left>HGETALL</td><td style=text-align:left>RPOP</td><td style=text-align:left>SINTER</td><td style=text-align:left>ZCLEAR</td></tr><tr><td style=text-align:left>DECRBY</td><td style=text-align:left>HINCRBY</td><td style=text-align:left>LRANGE</td><td style=text-align:left>SINTERSTORE</td><td style=text-align:left>ZRANK</td></tr><tr><td style=text-align:left>DEL</td><td style=text-align:left>HKEYS</td><td style=text-align:left>LSET</td><td style=text-align:left>SISMEMBER</td><td style=text-align:left>ZRANGE</td></tr><tr><td style=text-align:left>EXISTS</td><td style=text-align:left>HLEN</td><td style=text-align:left>LLEN</td><td style=text-align:left>SMEMBERS</td><td style=text-align:left>ZREVRANGE</td></tr><tr><td style=text-align:left>GET</td><td style=text-align:left>HMGET</td><td style=text-align:left>RPOPLPUSH</td><td style=text-align:left>SREM</td><td style=text-align:left>ZSCORE</td></tr><tr><td style=text-align:left>GETBIT</td><td style=text-align:left>HMSET</td><td style=text-align:left>LCLEAR</td><td style=text-align:left>SUNION</td><td style=text-align:left>ZINCRBY</td></tr><tr><td style=text-align:left>SETBIT</td><td style=text-align:left>HSETEX</td><td style=text-align:left>LCLEAR</td><td style=text-align:left>SUNIONSTORE</td><td style=text-align:left>ZREVRANK</td></tr><tr><td style=text-align:left>GETRANGE</td><td style=text-align:left>HSTRLEN</td><td style=text-align:left>LMCLEAR</td><td style=text-align:left>SCLEAR</td><td style=text-align:left>ZRANGEBYSCORE</td></tr><tr><td style=text-align:left>GETSET</td><td style=text-align:left>HVALS</td><td style=text-align:left>LEXPIRE</td><td style=text-align:left>SMCLEAR</td><td style=text-align:left>ZREVRANGEBYSCORE</td></tr><tr><td style=text-align:left>INCR</td><td style=text-align:left>HCLEAR</td><td style=text-align:left>LEXPIREAT</td><td style=text-align:left>SEXPIRE</td><td style=text-align:left>ZREMRANGEBYSCORE</td></tr><tr><td style=text-align:left>EXISTS</td><td style=text-align:left>HMCLEAR</td><td style=text-align:left>LKEYEXISTS</td><td style=text-align:left>SEXPIRE</td><td style=text-align:left>ZREMRANGEBYRANK</td></tr><tr><td style=text-align:left>GET</td><td style=text-align:left>HEXPIRE</td><td style=text-align:left>LTRIM</td><td style=text-align:left>SEXPIREAT</td><td style=text-align:left></td></tr><tr><td style=text-align:left>GETBIT</td><td style=text-align:left>HEXPIREAT</td><td style=text-align:left>LTTL</td><td style=text-align:left>STTL</td><td style=text-align:left></td></tr><tr><td style=text-align:left>SETBIT</td><td style=text-align:left>HKEYEXIST</td><td style=text-align:left></td><td style=text-align:left>SPERSIST</td><td style=text-align:left></td></tr><tr><td style=text-align:left>GETRANGE</td><td style=text-align:left>HTTL</td><td style=text-align:left></td><td style=text-align:left>SKEYEXISTS</td><td style=text-align:left></td></tr><tr><td style=text-align:left>GETSET</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>INCRBY</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>GET</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>MGET</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>MSET</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>SET</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>SETEX</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>SETEXAT</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>SETRANGE</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>EXPIRE</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>EXPIREAT</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr><tr><td style=text-align:left>TTL</td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td><td style=text-align:left></td></tr></tbody></table><h2 id=cluster-control-protocol>Cluster control protocol
<a class=anchor href=#cluster-control-protocol>#</a></h2><p>IceFireDB-NoSQL integrates some Redis cluster status instructions in the RAFT parallel database scenario.</p><pre tabindex=0><code>VERSION                                 # show the application version
MACHINE                                 # show information about the state machine
RAFT LEADER                             # show the address of the current raft leader
RAFT INFO [pattern]                     # show information about the raft server and cluster
RAFT SERVER LIST                        # show all servers in cluster
RAFT SERVER ADD id address              # add a server to cluster
RAFT SERVER REMOVE id                   # remove a server from the cluster
RAFT SNAPSHOT NOW                       # make a snapshot of the data
RAFT SNAPSHOT LIST                      # show a list of all snapshots on server
RAFT SNAPSHOT FILE id                   # show the file path of a snapshot on server
RAFT SNAPSHOT READ id [RANGE start end] # download all or part of a snapshot
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#protocol-advantages>Protocol advantages</a></li><li><a href=#data-control-protocol>Data control protocol</a></li><li><a href=#cluster-control-protocol>Cluster control protocol</a></li></ul></nav></div></aside></main></body></html>