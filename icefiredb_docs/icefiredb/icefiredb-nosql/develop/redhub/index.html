<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  redhub-frame
  #


  Project introduction
  #

High-performance Redis-Server multi-threaded framework, based on RawEpoll model.

  Features
  #


Ultra high performance
Fully multi-threaded support
Low CPU resource consumption
Compatible with redis protocol
Create a Redis compatible server with RawEpoll model in Go


  Installing
  #

go get -u github.com/IceFireDB/redhub

  Example
  #

Here is a simple framework usage example,support the following redis commands:

SET key value
GET key
DEL key
PING
QUIT

You can run this example in terminal:"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:type" content="website"><meta property="og:image" content="https://res.cloudinary.com/malloc/image/upload/v1666510486/icefiredb/logo_z8koem.png"><meta property="og:url" content="https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/redhub/"><meta property="og:site_name" content="IceFireDB Documentation"><meta property="og:title" content="redhub-frame"><meta property="og:description" content=" redhub-frame # Project introduction # High-performance Redis-Server multi-threaded framework, based on RawEpoll model.
Features # Ultra high performance Fully multi-threaded support Low CPU resource consumption Compatible with redis protocol Create a Redis compatible server with RawEpoll model in Go Installing # go get -u github.com/IceFireDB/redhub Example # Here is a simple framework usage example,support the following redis commands:
SET key value GET key DEL key PING QUIT You can run this example in terminal:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="icefiredb"><title>redhub-frame | IceFireDB Documentation</title>
<link rel=manifest href=/icefiredb_docs/manifest.json><link rel=icon href=/icefiredb_docs/favicon.ico type=image/x-icon><link rel=stylesheet href=/icefiredb_docs/book.min.b217cc02c67832c758393b43eb4be5c8cf053fb3c4a02dee3fdd3805ce53f993.css integrity="sha256-shfMAsZ4MsdYOTtD60vlyM8FP7PEoC3uP904Bc5T+ZM=" crossorigin=anonymous><script defer src=/icefiredb_docs/flexsearch.min.js></script><script defer src=/icefiredb_docs/en.search.min.e2d4ffbe7302880d97331bdf5598cd4a2e1adc1179e111d1cae5f4bedfad98a3.js integrity="sha256-4tT/vnMCiA2XMxvfVZjNSi4a3BF54RHRyuX0vt+tmKM=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/icefiredb_docs/><span>IceFireDB Documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://www.icefiredb.xyz/ target=_blank rel=noopener>Official Site</a></li><li><a href=https://github.com/icefiredb target=_blank rel=noopener>Open Source</a></li></ul><ul><li class=book-section-flat><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/>Overview</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/engine_overview/>Engine Overview</a><ul></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/vocabulary/>Vocabulary</a><ul></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/>IceFireDB NoSQL Engine</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/quick_start/>Quick Start</a><ul></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/>Designs</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/overview/>Overview</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/network/>Network layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/storage/>Storage layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/protocol/>Protocol layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/codec/>Codec layer</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/designs/storage-drivers/>Storage Drivers</a></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/tutorials/>Tutorials</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/tutorials/getting-started/>Getting Started Tutorial</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/tutorials/performance-benchmarking/>Performance Benchmarking</a></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/deploy/>Deploy</a><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/deploy/configuration/>Configuration Guide</a></li></ul></li><li><span>Develop</span><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb-crdt-kv/>icefiredb-crdt-kv</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb-ipfs-log/>icefiredb-ipfs-log</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/icefiredb_proxy/>icefiredb-proxy</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/redhub/ class=active>redhub-frame</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/develop/api-reference/>API Reference</a></li></ul></li><li><span>Project Comparison</span><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/project-comparison/orbitdb/>OrbitDB</a></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-nosql/project-comparison/threaddb/>ThreadDB</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/>IceFireDB-SQLite</a><ul><li><input type=checkbox id=section-d28adc5f935baf9f2270b11342515dec class=toggle>
<label for=section-d28adc5f935baf9f2270b11342515dec class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlite/architecture/overview/>Overview</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/>IceFireDB-Redis-Proxy</a><ul><li><input type=checkbox id=section-197cd7a03ef88813eee099fa35466d3e class=toggle>
<label for=section-197cd7a03ef88813eee099fa35466d3e class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-redis-proxy/architecture/overview/>Overview</a></li></ul></li></ul></li><li><span>IceFireDB-SQLProxy</span><ul><li><input type=checkbox id=section-87903bd5b525679072ad1825563a57f2 class=toggle>
<label for=section-87903bd5b525679072ad1825563a57f2 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-sqlproxy/architecture/overview/>Overview</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/>IceFireDB-PubSub</a><ul><li><input type=checkbox id=section-d2e27c9da60e491bca2bc610c135b235 class=toggle>
<label for=section-d2e27c9da60e491bca2bc610c135b235 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/icefiredb-pubsub/architecture/overview/>Overview</a></li></ul></li></ul></li><li><a href=https://docs.icefiredb.xyz/icefiredb_docs/icefiredb/faqs/>Frequently Asked Questions</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/icefiredb_docs/svg/menu.svg class=book-icon alt=Menu>
</label><strong>redhub-frame</strong>
<label for=toc-control><img src=/icefiredb_docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#project-introduction>Project introduction</a></li><li><a href=#features>Features</a></li><li><a href=#installing>Installing</a></li><li><a href=#example>Example</a></li><li><a href=#benchmarks>Benchmarks</a><ul><li><a href=#redis-server503-single-threaded-no-disk-persistence>【Redis-server5.0.3】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-single-threaded-no-disk-persistence>【Redis-server6.2.5】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-multi-threaded-no-disk-persistence>【Redis-server6.2.5】 Multi-threaded, no disk persistence.</a></li><li><a href=#redcon-multi-threaded-no-disk-persistence>【RedCon】 Multi-threaded, no disk persistence</a></li><li><a href=#redhub-multi-threaded-no-disk-persistence>【RedHub】 Multi-threaded, no disk persistence</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=redhub-frame>redhub-frame
<a class=anchor href=#redhub-frame>#</a></h1><h2 id=project-introduction>Project introduction
<a class=anchor href=#project-introduction>#</a></h2><p>High-performance Redis-Server multi-threaded framework, based on RawEpoll model.</p><h2 id=features>Features
<a class=anchor href=#features>#</a></h2><ul><li>Ultra high performance</li><li>Fully multi-threaded support</li><li>Low CPU resource consumption</li><li>Compatible with redis protocol</li><li>Create a Redis compatible server with RawEpoll model in Go</li></ul><h2 id=installing>Installing
<a class=anchor href=#installing>#</a></h2><pre tabindex=0><code>go get -u github.com/IceFireDB/redhub
</code></pre><h2 id=example>Example
<a class=anchor href=#example>#</a></h2><p>Here is a simple framework usage example,support the following redis commands:</p><ul><li>SET key value</li><li>GET key</li><li>DEL key</li><li>PING</li><li>QUIT</li></ul><p>You can run this example in terminal:</p><pre tabindex=0><code class=language-lang data-lang=lang>package main

import (
	&#34;flag&#34;
	&#34;fmt&#34;
	&#34;log&#34;
	&#34;strings&#34;
	&#34;sync&#34;

	&#34;net/http&#34;
	_ &#34;net/http/pprof&#34;

	&#34;github.com/IceFireDB/redhub&#34;
	&#34;github.com/IceFireDB/redhub/pkg/resp&#34;
)

func main() {
	var mu sync.RWMutex
	var items = make(map[string][]byte)
	var network string
	var addr string
	var multicore bool
	var reusePort bool
	var pprofDebug bool
	var pprofAddr string
	flag.StringVar(&amp;network, &#34;network&#34;, &#34;tcp&#34;, &#34;server network (default \&#34;tcp\&#34;)&#34;)
	flag.StringVar(&amp;addr, &#34;addr&#34;, &#34;127.0.0.1:6380&#34;, &#34;server addr (default \&#34;:6380\&#34;)&#34;)
	flag.BoolVar(&amp;multicore, &#34;multicore&#34;, true, &#34;multicore&#34;)
	flag.BoolVar(&amp;reusePort, &#34;reusePort&#34;, false, &#34;reusePort&#34;)
	flag.BoolVar(&amp;pprofDebug, &#34;pprofDebug&#34;, false, &#34;open pprof&#34;)
	flag.StringVar(&amp;pprofAddr, &#34;pprofAddr&#34;, &#34;:8888&#34;, &#34;pprof address&#34;)
	flag.Parse()
	if pprofDebug {
		go func() {
			http.ListenAndServe(pprofAddr, nil)
		}()
	}

	protoAddr := fmt.Sprintf(&#34;%s://%s&#34;, network, addr)
	option := redhub.Options{
		Multicore: multicore,
		ReusePort: reusePort,
	}

	rh := redhub.NewRedHub(
		func(c *redhub.Conn) (out []byte, action redhub.Action) {
			return
		},
		func(c *redhub.Conn, err error) (action redhub.Action) {
			return
		},
		func(cmd resp.Command, out []byte) ([]byte, redhub.Action) {
			var status redhub.Action
			switch strings.ToLower(string(cmd.Args[0])) {
			default:
				out = resp.AppendError(out, &#34;ERR unknown command &#39;&#34;+string(cmd.Args[0])+&#34;&#39;&#34;)
			case &#34;ping&#34;:
				out = resp.AppendString(out, &#34;PONG&#34;)
			case &#34;quit&#34;:
				out = resp.AppendString(out, &#34;OK&#34;)
				status = redhub.Close
			case &#34;set&#34;:
				if len(cmd.Args) != 3 {
					out = resp.AppendError(out, &#34;ERR wrong number of arguments for &#39;&#34;+string(cmd.Args[0])+&#34;&#39; command&#34;)
					break
				}
				mu.Lock()
				items[string(cmd.Args[1])] = cmd.Args[2]
				mu.Unlock()
				out = resp.AppendString(out, &#34;OK&#34;)
			case &#34;get&#34;:
				if len(cmd.Args) != 2 {
					out = resp.AppendError(out, &#34;ERR wrong number of arguments for &#39;&#34;+string(cmd.Args[0])+&#34;&#39; command&#34;)
					break
				}
				mu.RLock()
				val, ok := items[string(cmd.Args[1])]
				mu.RUnlock()
				if !ok {
					out = resp.AppendNull(out)
				} else {
					out = resp.AppendBulk(out, val)
				}
			case &#34;del&#34;:
				if len(cmd.Args) != 2 {
					out = resp.AppendError(out, &#34;ERR wrong number of arguments for &#39;&#34;+string(cmd.Args[0])+&#34;&#39; command&#34;)
					break
				}
				mu.Lock()
				_, ok := items[string(cmd.Args[1])]
				delete(items, string(cmd.Args[1]))
				mu.Unlock()
				if !ok {
					out = resp.AppendInt(out, 0)
				} else {
					out = resp.AppendInt(out, 1)
				}
			case &#34;config&#34;:
				// This simple (blank) response is only here to allow for the
				// redis-benchmark command to work with this example.
				out = resp.AppendArray(out, 2)
				out = resp.AppendBulk(out, cmd.Args[2])
				out = resp.AppendBulkString(out, &#34;&#34;)
			}
			return out, status
		},
	)
	log.Printf(&#34;started redhub server at %s&#34;, addr)
	err := redhub.ListendAndServe(protoAddr, option, rh)
	if err != nil {
		log.Fatal(err)
	}
}
</code></pre><h2 id=benchmarks>Benchmarks
<a class=anchor href=#benchmarks>#</a></h2><pre tabindex=0><code>Machine information
        OS : Debian Buster 10.6 64bit 
       CPU : 8 CPU cores
    Memory : 64.0 GiB

Go Version : go1.16.5 linux/amd64
</code></pre><h3 id=redis-server503-single-threaded-no-disk-persistence>【Redis-server5.0.3】 Single-threaded, no disk persistence.
<a class=anchor href=#redis-server503-single-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ ./redis-server --port 6380 --appendonly no
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 2306060.50 requests per second
GET: 3096742.25 requests per second
</code></pre><h3 id=redis-server625-single-threaded-no-disk-persistence>【Redis-server6.2.5】 Single-threaded, no disk persistence.
<a class=anchor href=#redis-server625-single-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ ./redis-server --port 6380 --appendonly no
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 2076325.75 requests per second
GET: 2652801.50 requests per second
</code></pre><h3 id=redis-server625-multi-threaded-no-disk-persistence>【Redis-server6.2.5】 Multi-threaded, no disk persistence.
<a class=anchor href=#redis-server625-multi-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>io-threads-do-reads yes
io-threads 8
$ ./redis-server redis.conf
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6379 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 1944692.88 requests per second
GET: 2375184.00 requests per second
</code></pre><h3 id=redcon-multi-threaded-no-disk-persistence>【RedCon】 Multi-threaded, no disk persistence
<a class=anchor href=#redcon-multi-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ go run example/clone.go
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 2332742.25 requests per second
GET: 14654162.00 requests per second
</code></pre><h3 id=redhub-multi-threaded-no-disk-persistence>【RedHub】 Multi-threaded, no disk persistence
<a class=anchor href=#redhub-multi-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ go run example/server.go
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 4087305.00 requests per second
GET: 16490765.00 requests per second
</code></pre><center><img width=550 alt=image src=https://res.cloudinary.com/malloc/image/upload/v1669104318/icefiredb/docs/134836128-423fd389-0fae-4e37-81c2-3b0066ed5f56_bk9hcs.png></center><center><img width=550 alt=image src=https://res.cloudinary.com/malloc/image/upload/v1669104334/icefiredb/docs/134836167-37c41c77-d77e-4ca8-96cb-4bab8ab65fa0_cu9icn.png></center></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#project-introduction>Project introduction</a></li><li><a href=#features>Features</a></li><li><a href=#installing>Installing</a></li><li><a href=#example>Example</a></li><li><a href=#benchmarks>Benchmarks</a><ul><li><a href=#redis-server503-single-threaded-no-disk-persistence>【Redis-server5.0.3】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-single-threaded-no-disk-persistence>【Redis-server6.2.5】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-multi-threaded-no-disk-persistence>【Redis-server6.2.5】 Multi-threaded, no disk persistence.</a></li><li><a href=#redcon-multi-threaded-no-disk-persistence>【RedCon】 Multi-threaded, no disk persistence</a></li><li><a href=#redhub-multi-threaded-no-disk-persistence>【RedHub】 Multi-threaded, no disk persistence</a></li></ul></li></ul></nav></div></aside></main></body></html>